<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <f:metadata>
        <f:event type="preRenderView" listener="#{sessionController.watchOut()}" />
    </f:metadata>
    <body>

        <ui:composition template="./index.xhtml">

            <ui:define name="content">
                <h:body>

                    <p:layout style="min-width:400px; min-height:200px; height: 100%; width: 90%;">
                        <p:layoutUnit position="center">
                            <div style="margin-left: 150px; margin-right: 150px;" class="row">
                                <div class="col s12 m7">
                                    <h:form>
                                        <div style="height: 500px; width: 300px;" class="card">
                                            <div class="card-image">
                                                <img style="height: 400px;" src="resources/images/photo_profil/#{sessionController.currentUser.photos}"/>
                                                <span class="card-title">#{lm.MonProfil}</span>
                                            </div>
                                            <div class="card-content">
                                                <center style="font-size: 14px; font-weight: bold;">
                                                    <h:form id="form_profil_msg">
                                                        <h:outputText id="msg" value="#{sessionController.msg}" style="color: green; font-size: 16px; font-weight: bold;"/><br/>
                                                    </h:form>
                                                    <span>#{sessionController.currentUser.nompers}  #{sessionController.currentUser.prenompers}</span>
                                                    <center>
                                                        <p:commandButton class="btn waves-effect waves-light btn col s2 circle" widgetVar="wv_mon_profil"  actionListener="#{personnelController.action}" partialSubmit="true" oncomplete="PF('wv_ma_photo').show()" value="+"/>
                                                    </center>
                                                </center>
                                            </div>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                            <ul style="margin-left: 475px;" class="collapsible" data-collapsible="accordion">

                                <li style="margin-top: -515px;">
                                    <div style="font-size: 14px; font-weight: bold; width: 100%;" class="collapsible-header">
                                        <!--<i class="material-icons">filter_drama</i>-->
                                        #{lm.Nom}, #{lm.Prenom}
                                    </div>
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Nom} :    #{sessionController.currentUser.nompers}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Prenom} :    #{sessionController.currentUser.prenompers}</span>
                                    </div>
                                </li>
                                <li>
                                    <div style="font-size: 14px; font-weight: bold; width: 100%;" class="collapsible-header">
                                        <!--<i class="material-icons">filter_drama</i>-->
                                        #{lm.Matricule}, #{lm.Poste}
                                    </div>
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Matricule} :    #{sessionController.currentUser.matricule}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Poste} :    #{sessionController.currentUser.poste}</span>
                                    </div>
                                </li>
                                <li>
                                    <div style="font-size: 14px; font-weight: bold;" class="collapsible-header">
                                        <!--<i class="material-icons">place</i>-->
                                        #{lm.Datenaiss}, #{lm.Dateembauche}
                                    </div>
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Datenaiss} :    #{sessionController.currentUser.datenaisspers}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Dateembauche} :    #{sessionController.currentUser.datedeb}</span>
                                    </div>
                                </li>
                                <li>
                                    <div style="font-size: 14px; font-weight: bold;" class="collapsible-header">
                                        <!--<i class="material-icons">place</i>-->
                                        #{lm.Email}, #{lm.CNI}, #{lm.Telephone}
                                    </div>
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Email} :    #{sessionController.currentUser.email}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.CNI} :    #{sessionController.currentUser.cnipers}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Telephone} :    #{sessionController.currentUser.tel}</span>
                                    </div>
                                </li>
                                <li>
                                    <div style="font-size: 14px; font-weight: bold;" class="collapsible-header">
                                        <!--<i class="material-icons">place</i>-->
                                        #{lm.Pays}, #{lm.Ville}, #{lm.Quartier}
                                    </div>   
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Pays} :    #{sessionController.currentUser.pays}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Ville} :    #{sessionController.currentUser.ville}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Quartier} :    #{sessionController.currentUser.quartier}</span>
                                    </div>
                                </li>
                                <li>
                                    <div style="font-size: 14px; font-weight: bold;" class="collapsible-header">
                                        <!--<i class="material-icons">place</i>-->
                                        #{lm.Login}, #{lm.MotDePasse}
                                    </div>
                                    <div class="collapsible-body">
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.Login} :    #{sessionController.currentUser.login}</span><br/>
                                        <span class="text-lighten-1 waves-effect green-text" style="font-size: 14px; font-style: oblique; font-size-adjust: initial; font-weight: bold">#{lm.MotDePasse} :    #{sessionController.currentUser.password}</span>
                                    </div><br/>
                                    <h:form id="form_infos">
                                        <center>
                                            <p:commandButton class="btn waves-effect waves-light btn col s2" widgetVar="modifyProfil"  actionListener="#{personnelController.action}" update=":form_mon_profil:fm_mon_profil" partialSubmit="true" oncomplete="PF('wv_mon_profil').show()" value="#{lm.Modifier}"/>
                                        </center>
                                    </h:form>
                                </li>
                            </ul>
                        </p:layoutUnit>

                        <h:form id="form_mon_profil">
                            <p:notificationBar position="top" effect="slide" styleClass="top" widgetVar="bar">
                                <h:outputText id="msg" value="#{sessionController.msg}" style="font-size:30px; font-weight: bold; font-style: italic;color: #009900;" />
                                <p:commandButton style="margin-left: 100px;" value="Hide" onclick="PF('bar').hide()" type="button" icon="ui-icon-arrow-1-n"/>
                            </p:notificationBar>
                            <p:dialog showEffect="drop" modal="true" id="fm_mon_profil" widgetVar="wv_mon_profil">
                                <h:panelGrid id="inputs" style="text-align: justify;" columns="2">
                                    <p:outputLabel style="color: green; font-weight: bold; text-decoration: underline;" value="#{lm.Email} : " for="email" />
                                    <p:inputText style="color: green; font-weight: bold;" value="#{sessionController.currentUser.email}" id="email" />
                                    <p:outputLabel style="color: green; font-weight: bold; text-decoration: underline;" value="#{lm.Telephone} : " for="tel" />
                                    <p:inputMask mask="999-999-999" value="#{sessionController.currentUser.tel}" id="tel" />
                                    <p:outputLabel style="color: green; font-weight: bold; text-decoration: underline;" value="#{lm.Quartier} : " for="quartier" />
                                    <p:inputText style="color: green; font-weight: bold;" value="#{sessionController.currentUser.quartier}" id="quartier" />
                                    <p:outputLabel style="color: green; font-weight: bold;" value="#{lm.Login} : " for="login" />
                                    <p:inputText style="color: green; font-weight: bold;" value="#{sessionController.currentUser.login}" id="login" />
                                    <p:outputLabel style="color: green; font-weight: bold;" value="#{lm.MotDePasse} : " for="password" />
                                    <p:password feedback="true"  style="color: green; font-weight: bold;" value="#{sessionController.currentUser.password}" id="password" />
                                </h:panelGrid>
                                <p:separator/>
                                <f:facet name="footer">
                                    <center>
                                        <p:commandButton oncomplete="PF('bar').show()" icon="ui-icon-arrow-1-s" class="btn waves-effect waves-light btn btn-flat" update="inputs" id="ok" value="#{lm.Modifier}" action="#{sessionController.modifyProfil()}" />
                                    </center> 
                                </f:facet>
                            </p:dialog>
                            <p:dialog showEffect="drop"  id="wv_ma_photo" widgetVar="wv_ma_photo">
                                <h:panelGrid id="inputs_photo" style="text-align: justify;" columns="2">
                                    <p:fileUpload fileUploadListener="#{sessionController.handleFileUpload}" mode="advanced" dragDropSupport="false" cancelLabel="Annulé" uploadLabel="Envoyé" label="choisir" 
                                                  multiple="true" update="inputs" fileLimitMessage="nombre de pieces limite atteind" 
                                                  invalidFileMessage="fichiers incorrect" invalidSizeMessage="taille invalide" requiredMessage="champs requis" required="true" 
                                                  sizeLimit="99999999" fileLimit="8" allowTypes="/(\.|\/)(gif|jpe?g|png|pdf|doc|docx|xls|xlsx|xlsm)$/i" />
                                </h:panelGrid>
                                <p:separator/>
                                <f:facet name="footer">
                                    <center>
                                        <p:commandButton oncomplete="PF('bar').show()" icon="ui-icon-arrow-1-s" class="btn waves-effect waves-light btn btn-flat" update="inputs" value="#{lm.Modifier}" action="#{sessionController.modifyProfil()}" />
                                    </center> 
                                </f:facet>
                            </p:dialog>
                        </h:form>
                    </p:layout>
                </h:body>
            </ui:define>

        </ui:composition>

    </body>
</html>
