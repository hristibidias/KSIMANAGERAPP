<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <f:metadata>
        <f:event type="preRenderView" listener="#{sessionController.watchOut()}" />
    </f:metadata>
    <body>

        <ui:composition template="./index.xhtml">

            <ui:define name="content">
                <h:form id="liste_mission">
                    <center>
                        <h4><h:outputText value="#{lm.ListeMission}" style="color: green;"/></h4>
                        <h6><h:outputText id="msg" value="#{missionController.msg}" style="color: green;"/></h6>
                    </center>
                    <p:dataTable cellSeparator="false" rows="10" paginator="true" id="table" widgetVar="ordM" sortMode="multiple" scrollable="true" emptyMessage="aucun resultats avec ce critére" scrollHeight="282" value="#{missionController.listMission}" var="item" rowKey="#{item.idmission}" selectionMode="single" selection="#{missionController.mission}">
                        <f:facet name="header">
                            <p:outputPanel>
                                <h:outputText value=" #{lm.Rechercher}  :" />
                                <p:inputText id="globalFilter" onkeyup="PF('ordM').filter()" style="width:100px" placeholder="#{lm.Motcle}"/>
                            </p:outputPanel>
                        </f:facet>
                        <p:column sortBy="#{item.datedebmission}" filterBy="#{item.datedebmission}" filterMatchMode="contains">
                            <f:facet name="header">
                                <h:outputText value="Date de debut"/>
                            </f:facet>
                            <h:outputText value="#{item.datedebmission}">
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>
                        </p:column>
                        <p:column sortBy="#{item.datefinmission}" filterBy="#{item.datefinmission}" filterMatchMode="contains">
                            <f:facet name="header">
                                <h:outputText value="Date de fin"/>
                            </f:facet>
                            <h:outputText value="#{item.datefinmission}">
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>
                        </p:column>
                        <p:column sortBy="#{item.lieumission}" filterBy="#{item.lieumission}" filterMatchMode="contains">
                            <f:facet name="header">
                                <h:outputText value="Lieu de la mission"/>
                            </f:facet>
                            <h:outputText value="#{item.lieumission}"/>
                        </p:column>
                        <p:column sortBy="#{item.descriptionmission}" filterBy="#{item.descriptionmission}" filterMatchMode="contains">
                            <f:facet name="header">
                                <h:outputText value="Description"/>
                            </f:facet>
                            <h:outputText value="#{item.descriptionmission}"/>
                        </p:column>
                        <p:column sortBy="#{item.statut}" filterBy="#{item.statut}" filterMatchMode="contains">
                            <f:facet name="header">
                                <h:outputText value="Statut"/>
                            </f:facet>
                            <h:outputText value="#{item.statut}"/>
                        </p:column>
                    </p:dataTable>
                    <p:separator/>

                    <div class="row" style="margin: auto;">
                        <p:commandButton style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" widgetVar="addMission"  actionListener="#{missionController.prepareCreate}" update="msg,:form_mission:fm_mission" partialSubmit="true" oncomplete="PF('wv_mission').show()" value="#{lm.Ajouter}"/>
                        <p:commandButton style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" widgetVar="modify"  actionListener="#{missionController.action}" update="msg,:form_mission:fm_mission" partialSubmit="true" oncomplete="PF('wv_mission').show()" value="#{lm.Modifier}"/>
                        <p:commandButton style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" widgetVar="delete"  actionListener="#{missionController.action}" update="msg,:form_mission:fm_mission" partialSubmit="true" oncomplete="PF('wv_mission').show()" value="#{lm.Supprimer}"/>
                        <p:commandButton style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" widgetVar="consult"  actionListener="#{missionController.action}" update="msg,:form_mission:fm_mission" partialSubmit="true" oncomplete="PF('wv_mission').show()" value="#{lm.Consulter}"/>
                        <p:commandButton style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" actionListener="#{missionController.initMission()}" update="table" partialSubmit="true" value="#{lm.Rafraichir}"/>
                    </div>
                </h:form>
                <p:separator/>
                <h:form id="form_mission">
                    <p:dialog showEffect="drop" modal="true" id="fm_mission" widgetVar="wv_mission">
                        <center>
                            <f:facet name="header">
                                <h:outputText rendered="#{!missionController.operation.equals('consult') and !missionController.operation.equals('delete') and !missionController.operation.equals('modify')}" value="Ajouter une mission" class="green-text" style="font-weight: bold;"/>
                                <h:outputText rendered="#{!missionController.operation.equals('consult') and !missionController.operation.equals('delete') and !missionController.operation.equals('addMission')}" value="Modifier une mission" class="green-text" style="font-weight: bold;"/>
                                <h:outputText rendered="#{!missionController.operation.equals('consult') and !missionController.operation.equals('addMission') and !missionController.operation.equals('modify')}" value="Supprimer une mission" class="green-text" style="font-weight: bold;"/>
                                <h:outputText rendered="#{!missionController.operation.equals('addMission') and !missionController.operation.equals('delete') and !missionController.operation.equals('modify')}" value="Consulter une mission" class="green-text" style="font-weight: bold;"/>
                            </f:facet>
                        </center>
                        <h:panelGrid columns="3">
                            <p:outputLabel value="#{lm.DateDebut} : " for="datedebmission" />
                            <p:calendar disabled="#{missionController.operation.equals('delete') or missionController.operation.equals('consult')}" pattern="dd/MM/yyyy" mask="true" effect="size" locale="de" navigator="true" required="true" requiredMessage="Champ obligatoire" id="datedebmission" value="#{missionController.mission.datedebmission}" title="Datedebmission" >
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </p:calendar>
                            <p:message for="datedebmission"/>
                            <p:outputLabel value="#{lm.DateFin} : " for="datefinmission" />
                            <p:calendar disabled="#{missionController.operation.equals('delete') or missionController.operation.equals('consult')}" pattern="dd/MM/yyyy" mask="true" effect="size" locale="de" navigator="true" required="true" requiredMessage="Champ obligatoire" id="datefinmission" value="#{missionController.mission.datefinmission}" title="Datefinmission" >
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </p:calendar>
                            <p:message for="datedebmission"/>
                            <p:outputLabel value="Lieu de la mission:" for="lieumission" />
                            <p:inputText disabled="#{missionController.operation.equals('delete') or missionController.operation.equals('consult')}" id="lieumission" required="true" requiredMessage="Champ obligatoire" value="#{missionController.mission.lieumission}" title="Lieumission" />
                            <p:message for="lieumission"/>
                            <p:outputLabel value="Description : " for="descriptionmission" />
                            <p:inputTextarea disabled="#{missionController.operation.equals('delete') or missionController.operation.equals('consult')}" id="descriptionmission" required="true" requiredMessage="Champ obligatoire" value="#{missionController.mission.descriptionmission}" title="Descriptionmission" />
                            <p:message for="descriptionmission"/>
                            <p:outputLabel value="Statut:" for="statut" />
                            <p:selectOneMenu style="width: 100%;" required="true" requiredMessage="Champ obligatoire" disabled="#{missionController.operation.equals('delete') or missionController.operation.equals('consult')}" id="statut" value="#{missionController.mission.statut}" >
                                <f:selectItem itemLabel="En attente" itemValue="En attente"/>
                                <f:selectItem itemLabel="En cours" itemValue="En cours"/>
                                <f:selectItem itemLabel="Terminée" itemValue="Terminée"/>
                            </p:selectOneMenu>
                            <p:message for="statut"/>
                        </h:panelGrid>
                        <f:facet name="footer">
                            <center>
                                <p:commandButton rendered="#{!missionController.operation.equals('consult') and !missionController.operation.equals('delete')}" style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" actionListener="#{missionController.persist()}" update=":liste_mission:table,:liste_mission:msg" partialSubmit="true" value="Enregistrer"/>
                                <p:commandButton rendered="#{!missionController.operation.equals('consult') and !missionController.operation.equals('addMission') and !missionController.operation.equals('modify')}" style="margin-left: 30px;" class="btn waves-effect waves-light btn col s2" actionListener="#{missionController.persist()}" update=":liste_mission:table,:liste_mission:msg" partialSubmit="true" value="Supprimer"/>
                            </center>
                        </f:facet>
                    </p:dialog>
                </h:form>
            </ui:define>

        </ui:composition>

    </body>
</html>
